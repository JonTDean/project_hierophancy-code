---
alwaysApply: true
description: Keep /docs/references/file_structure.md in sync with the actual repo tree (Python hex-arch + algorithms).
---

# Directory Structure Tracking (project_hierophancy)

## Purpose
Continuously maintain an accurate directory map as the single source of truth for repository layout.

## Trigger Events
- File/dir created, moved/renamed, or deleted
- Codegen outputs added/removed
- Refactors across hex layers (domain/port/adapter)
- Algorithm module/version added

## Actions to Take

1. **Read current structure** from `/docs/references/file_structure.md`.

2. **Scan the file system** (root of repo), **excluding**:
   - `.git/`, `.idea/`, `.vscode/`, `.DS_Store`
   - `__pycache__/`, `.mypy_cache/`, `.pytest_cache/`, `.ruff_cache/`, `.tox/`
   - `.venv/`, `venv/`, `dist/`, `build/`, `coverage/`
   - `node_modules/`, `.next/`, `.turbo/`, `out/`
   - `*.ipynb_checkpoints/`

   Record these roots (when present):
```

src/
â””â”€â”€ lib/
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ types/
â”‚   â””â”€â”€ services/
â”œâ”€â”€ port/
â”œâ”€â”€ adapter/
â”‚   â”œâ”€â”€ graph/
â”‚   â”œâ”€â”€ layout/
â”‚   â”œâ”€â”€ visualizer/
â”‚   â””â”€â”€ io/
tests/
â”œâ”€â”€ unit/
â””â”€â”€ integration/
notebooks/
apps/           (optional TS/React UI)
scripts/
docs/
â””â”€â”€ references/

```

3. **Replace** the contents of `/docs/references/file_structure.md` with the new tree.

4. **Annotate status** for key files using:
- `âœ…` implemented/verified
- `ğŸ”„` in-progress
- `ğŸ“` planned
- `âŒ` deprecated/removed

## Reference File
- **Primary**: `/docs/references/file_structure.md`
- **Update**: Real-time (on change) or via CI on PR
- **Format**: Markdown code-fenced tree

## Integration Notes
- Treat `domain/` as pure and dependency-light; `adapter/` may touch I/O/viz.
- Applied algorithms (e.g., Leiden) live under `src/lib/adapters/algorithms/<name>/` while the invariant definitions (distance, vectorization, normalization, lemmitization, and other task classes) live under `src/lib/domain/algorithms/<name>/`.
- Consider a lightweight script (`scripts/print_tree.py`) to regenerate the tree.
- Commit the updated reference with structural PRs.

## Example Output Format
```

src/
â””â”€â”€ lib/
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ graph.py                âœ… Core graph model
â”‚   â”‚   â””â”€â”€ partition.py            ğŸ”„ Community partition
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ nodes.py                âœ… NodeLike types
â”‚   â””â”€â”€ services/                   ğŸ“ Domain services (pure)
â”œâ”€â”€ port/
â”‚   â””â”€â”€ graph.py                    âœ… GraphBuilderPort, DeltaFn
â”œâ”€â”€ adapter/
â”‚   â”œâ”€â”€ graph/from_edges.py         âœ… Build graph from edge list
â”‚   â”œâ”€â”€ layout/random_layout.py     ğŸ“ Simple random layout
â”‚   â”œâ”€â”€ visualizer/convex_hull.py   âœ… Matplotlib visualizer
â”‚   â”œâ”€â”€ io/                         ğŸ“ Readers/Writers
â”‚   â””â”€â”€algorithms/
â”‚       â””â”€â”€ leiden/
â”‚           â”œâ”€â”€ core.py                 âœ… Top-level Leiden orchestration
â”‚           â”œâ”€â”€ delta.py                ğŸ”„ Objective (Î”H_P) strategies
â”‚           â”œâ”€â”€ refine.py               ğŸ”„ Refinement stage helpers
â”‚           â””â”€â”€ aggregate.py            âœ… Graph aggregation
â””â”€â”€ utils/
   â”œâ”€â”€ logging.py                  âœ… Logger config
   â””â”€â”€ timer.py                    âœ… Scoped timers

tests/
â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ test_graph.py                   âœ… Graph invariants
â”‚   â”œâ”€â”€ test_partition.py               âœ… Partition ops
â”‚   â””â”€â”€ test_leiden_core.py             ğŸ”„ Small graphs / expected splits
â””â”€â”€ integration/
â””â”€â”€ test_end_to_end.py              ğŸ“ Pipeline checks

notebooks/                               ğŸ“ Exploratory runs
apps/                                    ğŸ“ Optional TS/React UI
scripts/                                 âœ… Dev tooling
docs/
â””â”€â”€ references/
â””â”€â”€ file_structure.md               âœ… (this file)

```

## Status Indicators Legend
- `âœ…` Implemented & verified
- `ğŸ”„` In progress
- `ğŸ“` Planned
- `âŒ` Deprecated/removed
- *(none)* Standard item

